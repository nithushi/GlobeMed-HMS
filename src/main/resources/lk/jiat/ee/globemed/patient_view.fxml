<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.ChoiceBox?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableRow?>
<?import javafx.util.Callback?>
<?import javafx.scene.control.ComboBox?>
<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="lk.jiat.ee.globemed.PatientView"
            prefHeight="720.0" prefWidth="1200.0"
            style="-fx-background-color: #f8fafc; -fx-font-family: 'Poppins';">

    <!-- Main Content -->
    <center>

        <ScrollPane fitToWidth="true"
                    style="-fx-background-color: transparent; -fx-background: transparent;">
        <VBox spacing="30" style="-fx-padding: 35;">

            <!-- Patient Form Card -->
            <StackPane>
                <!-- Card Shadow -->
                <Region style="-fx-background-color: rgba(0,0,0,0.05); -fx-background-radius: 20;
                  -fx-translate-x: 3; -fx-translate-y: 6;"/>

                <!-- Main Card -->
                <VBox spacing="20" style="-fx-background-color: white; -fx-background-radius: 18;
                              -fx-padding: 30; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15,0,0,5);">

                    <!-- Form Header -->
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <StackPane>
                            <Region prefWidth="50" prefHeight="50"
                                    style="-fx-background-color: #e0e7ff; -fx-background-radius: 25;"/>
                            <Label text="ðŸ“" style="-fx-font-size: 24px;"/>
                        </StackPane>
                        <VBox spacing="3">
                            <Label text="Patient Information"
                                   style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #1f2937; -fx-font-family: 'SF Pro Display';"/>
                            <Label text="Enter patient details below"
                                   style="-fx-font-size: 13px; -fx-text-fill: #6b7280; -fx-font-family: 'SF Pro Display';"/>
                        </VBox>
                    </HBox>

                    <!-- Elegant Separator -->
                    <Region prefHeight="1" style="-fx-background-color: #e5e7eb;"/>

                    <!-- Form Grid -->
                    <GridPane hgap="25" vgap="20" style="-fx-padding: 10 0;">
                        <!-- Row 1 -->
                        <VBox spacing="8" GridPane.rowIndex="0" GridPane.columnIndex="0">
                            <Label text="First Name" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <TextField fx:id="firstNameField" promptText="Enter first name"
                                       style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-font-size: 13px; -fx-pref-width: 250px;"/>
                        </VBox>

                        <VBox spacing="8" GridPane.rowIndex="0" GridPane.columnIndex="1">
                            <Label text="Last Name" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <TextField fx:id="lastNameField" promptText="Enter last name"
                                       style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-font-size: 13px; -fx-pref-width: 250px;"/>
                        </VBox>

                        <!-- Row 2 -->
                        <VBox spacing="8" GridPane.rowIndex="1" GridPane.columnIndex="0">
                            <Label text="Date of Birth" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <DatePicker fx:id="dobPicker" promptText="Select date"
                                        style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-pref-width: 250px;"/>
                        </VBox>

                        <VBox spacing="8" GridPane.rowIndex="1" GridPane.columnIndex="1">
                            <Label text="Gender" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <ComboBox fx:id="genderChoice" promptText="Select Gender"
                                      style="-fx-background-color: #f9fafb;
                                                -fx-border-color: #d1d5db;
                                                -fx-border-radius: 10;
                                                -fx-background-radius: 10;
                                                -fx-padding: 10 12;
                                                -fx-font-size: 13px;
                                                -fx-pref-width: 250px;
                                                -fx-cursor: hand;"/>

                        </VBox>

                        <!-- Row 3 -->
                        <VBox spacing="8" GridPane.rowIndex="2" GridPane.columnIndex="0">
                            <Label text="Phone Number" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <TextField fx:id="phoneField" promptText="+94 XX XXX XXXX"
                                       style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-font-size: 13px; -fx-pref-width: 250px;"/>
                        </VBox>

                        <VBox spacing="8" GridPane.rowIndex="2" GridPane.columnIndex="1">
                            <Label text="Email Address" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <TextField fx:id="emailField" promptText="example@email.com"
                                       style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-font-size: 13px; -fx-pref-width: 250px;"/>
                        </VBox>

                        <!-- Row 4 - Full Width -->
                        <VBox spacing="8" GridPane.rowIndex="3" GridPane.columnIndex="0" GridPane.columnSpan="2">
                            <Label text="Medical History And Treatment Plans" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #374151;"/>
                            <TextArea fx:id="historyField" prefRowCount="4" promptText="Enter relevant medical history and notes..."
                                      style="-fx-background-color: #f9fafb; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 12; -fx-font-size: 13px; -fx-pref-width: 530px;"/>
                        </VBox>
                    </GridPane>
                </VBox>
            </StackPane>


            <!-- Action Buttons -->
            <HBox spacing="18" alignment="CENTER">
                <Button text="Add Patient" onAction="#onAddPatient" style="-fx-background-color: #10b981; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 180px; -fx-padding: 12 0;"/>
                <Button text="Update" onAction="#onUpdatePatient" style="-fx-background-color: #f59e0b; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 180px; -fx-padding: 12 0;"/>
                <Button text="Delete" onAction="#onDeletePatient" style="-fx-background-color: #3b82f6; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 180px; -fx-padding: 12 0;"/>
                <Button text="Clear Form" onAction="#onClearForm" style="-fx-background-color: #6366f1; -fx-text-fill: white; -fx-font-weight: bold; -fx-pref-width: 180px; -fx-padding: 12 0;"/>
            </HBox>

            <!-- Patient Records Table -->
            <StackPane>
                <!-- Table Card Shadow -->
                <Region style="-fx-background-color: rgba(0,0,0,0.04); -fx-background-radius: 20;
                              -fx-translate-x: 2; -fx-translate-y: 4;"/>

                <!-- Table Card -->
                <VBox spacing="18" style="-fx-background-color: white; -fx-background-radius: 18;
                                          -fx-padding: 30; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 12,0,0,4);">

                    <!-- Table Header -->
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <StackPane>
                            <Region prefWidth="50" prefHeight="50"
                                    style="-fx-background-color: #fef3c7; -fx-background-radius: 25;"/>
                            <Label text="ðŸ“‹" style="-fx-font-size: 24px;"/>
                        </StackPane>
                        <VBox spacing="3">
                            <Label text="Patient Records Database"
                                   style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #1f2937;"/>
                            <Label text="Complete list of registered patients"
                                   style="-fx-font-size: 13px; -fx-text-fill: #6b7280;"/>
                        </VBox>
                    </HBox>

                    <!-- Table Separator -->
                    <Region prefHeight="1" style="-fx-background-color: #e5e7eb;"/>
                    <TableView fx:id="patientTable" prefHeight="400"
                               style="-fx-background-color: #e0f0ff;  /* light blue background for table */
                  -fx-border-color: #3f7cdd;
                  -fx-border-width: 1;
                  -fx-border-radius: 12;
                  -fx-background-radius: 12;
                  -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 3);
                  -fx-cell-size: 45;
                  -fx-font-size: 15px;
                  -fx-font-family: 'Segoe UI', 'Inter', Arial, sans-serif;">

                        <columns>
                            <TableColumn fx:id="colId" text="ID" prefWidth="80"
                                         style="-fx-text-fill: #374151;
                            -fx-font-weight: 600;
                            -fx-alignment: CENTER;
                            -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colFirstName" text="First Name" prefWidth="150"
                                         style="-fx-text-fill: black; -fx-font-weight: 600; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colLastName" text="Last Name" prefWidth="150"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colDob" text="Birth Date" prefWidth="130"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-alignment: CENTER; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colGender" text="Gender" prefWidth="100"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-alignment: CENTER; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colPhone" text="Phone" prefWidth="150"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colEmail" text="Email" prefWidth="220"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-padding: 0 10 0 10;"/>

                            <TableColumn fx:id="colHistory" text="Medical History" prefWidth="220"
                                         style="-fx-text-fill: #374151; -fx-font-weight: 600; -fx-padding: 0 10 0 10;"/>
                        </columns>
                    </TableView>


                    <!-- Table Footer -->
                    <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 10 5 0 0;">
                        <Region prefWidth="20" prefHeight="20"
                                style="-fx-background-color: #10b981; -fx-background-radius: 10;"/>
                        <Label text="Active Records"
                               style="-fx-font-size: 13px; -fx-text-fill: #6b7280; -fx-font-weight: bold;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label text="Double-click to select record"
                               style="-fx-font-size: 12px; -fx-text-fill: #9ca3af; -fx-font-style: italic;"/>
                    </HBox>
                </VBox>
            </StackPane>
        </VBox>
        </ScrollPane>
    </center>
</BorderPane>